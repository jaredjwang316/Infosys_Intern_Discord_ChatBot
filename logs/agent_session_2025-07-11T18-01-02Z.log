2025-07-11 13:01:02,384 [WARNING] PyNaCl is not installed, voice will NOT be supported
2025-07-11 13:01:02,384 [INFO] logging in using static token
2025-07-11 13:01:03,117 [INFO] Shard ID None has connected to Gateway (Session ID: 858d1725c1a77ce8c4544b9befaff3fa).
2025-07-11 13:01:08,570 [INFO] ðŸ“¨ Message received â€” User: 8ruhmomentum (ID: 485308464050995245)
2025-07-11 13:01:08,570 [INFO] ðŸ“¨ Channel: general (ID: 1384535346905092127)
2025-07-11 13:01:08,570 [INFO] ðŸ’¬ Content: ask: Can you show me all employees?
2025-07-11 13:01:08,658 [INFO] User <@485308464050995245> (Admin) is using agent with tools: ['query', 'summarize', 'summarize_by_time', 'search']
2025-07-11 13:01:09,419 [INFO] Task: Show all employees from the database.
Tool calls: [{'name': 'query', 'args': {'user_query': 'Show all employees'}, 'id': '3ccf03fb-e725-4e5f-93df-737491364de4', 'type': 'tool_call'}]
2025-07-11 13:01:11,523 [INFO] Response does not contain any tool calls.
2025-07-11 13:01:35,115 [INFO] ðŸ“¨ Message received â€” User: 8ruhmomentum (ID: 485308464050995245)
2025-07-11 13:01:35,116 [INFO] ðŸ“¨ Channel: general (ID: 1384535346905092127)
2025-07-11 13:01:35,116 [INFO] ðŸ’¬ Content: ask: Can you now sort these employees by joining year in a bar chart?
2025-07-11 13:01:35,207 [INFO] User <@485308464050995245> (Admin) is using agent with tools: ['query', 'summarize', 'summarize_by_time', 'search']
2025-07-11 13:01:36,161 [INFO] Task: Visualize employees sorted by joining year in a bar chart. The data from the previous turn should be used.
Tool calls: [{'name': 'query', 'args': {'user_query': 'SELECT name, join_year FROM employees ORDER BY join_year'}, 'id': 'ae75c0c4-7477-4a59-be2d-834955604bdc', 'type': 'tool_call'}]
2025-07-11 13:01:37,325 [INFO] Response does not contain any tool calls.
2025-07-11 13:02:14,836 [INFO] ðŸ“¨ Message received â€” User: 8ruhmomentum (ID: 485308464050995245)
2025-07-11 13:02:14,836 [INFO] ðŸ“¨ Channel: general (ID: 1384535346905092127)
2025-07-11 13:02:14,836 [INFO] ðŸ’¬ Content: ask: Can you sort employees by year?
2025-07-11 13:02:14,958 [INFO] User <@485308464050995245> (Admin) is using agent with tools: ['query', 'summarize', 'summarize_by_time', 'search']
2025-07-11 13:02:16,389 [INFO] Task: The user wants to sort employees by their joining year. The previous attempt to visualize this data failed due to a `strftime` function error. The user is now asking to sort the employees by year, implying they want the data presented in a sorted manner, possibly visually. Given the previous error, I should first attempt to query the database for employee data and their joining years, and then present it in a sorted list format, as visualization is currently not working.
Tool calls: [{'name': 'query', 'args': {'user_query': 'Show all employees and their joining years, sorted by joining year.'}, 'id': '777c27f3-5f51-4b9f-a799-c2eaa57aed6e', 'type': 'tool_call'}]
2025-07-11 13:02:17,867 [INFO] Response does not contain any tool calls.
2025-07-11 13:02:18,511 [INFO] Shard ID None has successfully RESUMED session 858d1725c1a77ce8c4544b9befaff3fa.
2025-07-11 13:02:30,178 [INFO] ðŸ“¨ Message received â€” User: 8ruhmomentum (ID: 485308464050995245)
2025-07-11 13:02:30,179 [INFO] ðŸ“¨ Channel: general (ID: 1384535346905092127)
2025-07-11 13:02:30,179 [INFO] ðŸ’¬ Content: ask: Can you display this information as a bar chart?
2025-07-11 13:02:30,256 [INFO] User <@485308464050995245> (Admin) is using agent with tools: ['query', 'summarize', 'summarize_by_time', 'search']
2025-07-11 13:02:31,151 [INFO] Task: Visualize the employee data, sorted by joining year, as a bar chart using the query tool.
Tool calls: [{'name': 'query', 'args': {'user_query': 'Show employees sorted by joining year in a bar chart'}, 'id': '4cc63ba8-1960-4ab9-9182-87dffe5f7865', 'type': 'tool_call'}]
2025-07-11 13:02:31,961 [INFO] Response does not contain any tool calls.
2025-07-11 13:02:58,843 [INFO] ðŸ“¨ Message received â€” User: 8ruhmomentum (ID: 485308464050995245)
2025-07-11 13:02:58,843 [INFO] ðŸ“¨ Channel: general (ID: 1384535346905092127)
2025-07-11 13:02:58,843 [INFO] ðŸ’¬ Content: ask: Can you summarize the last day?
2025-07-11 13:02:58,943 [INFO] User <@485308464050995245> (Admin) is using agent with tools: ['query', 'summarize', 'summarize_by_time', 'search']
2025-07-11 13:02:59,725 [INFO] Task: Summarize the conversation history for the last day in the current channel.
Tool calls: [{'name': 'summarize_by_time', 'args': {'time_unit': 'days', 'rollback_time': 1.0, 'channel_id': '1384535346905092127'}, 'id': 'f18efb41-7f75-41f9-b388-8a01e5b433cf', 'type': 'tool_call'}]
2025-07-11 13:02:59,914 [INFO] HTTP Request: POST https://generativelanguage.googleapis.com/v1beta/models/text-embedding-004:batchEmbedContents "HTTP/1.1 200 OK"
2025-07-11 13:03:01,743 [INFO] Response contains tool calls: [{'name': 'summarize_by_time', 'args': {'time_unit': 'days', 'rollback_time': 1.0, 'channel_id': '1384535346905092127'}, 'id': '4cdafe81-2949-4190-99e7-f1578506732d', 'type': 'tool_call'}]
2025-07-11 13:03:04,156 [INFO] Response contains tool calls: [{'name': 'summarize_by_time', 'args': {'time_unit': 'days', 'rollback_time': 1.0, 'channel_id': '1384535346905092127'}, 'id': 'f8e8b950-6d6d-49dc-89db-16cb0ce0ddfe', 'type': 'tool_call'}]
2025-07-11 13:03:05,597 [INFO] Response contains tool calls: [{'name': 'summarize_by_time', 'args': {'rollback_time': 1.0, 'time_unit': 'days', 'channel_id': '1384535346905092127'}, 'id': 'd0511144-9001-44b9-8078-8da65b126a6a', 'type': 'tool_call'}]
2025-07-11 13:03:06,968 [INFO] Response contains tool calls: [{'name': 'summarize_by_time', 'args': {'time_unit': 'days', 'rollback_time': 1.0, 'channel_id': '1384535346905092127'}, 'id': 'f26bf8f5-155a-4da4-a59b-130047d7d122', 'type': 'tool_call'}]
2025-07-11 13:03:08,736 [INFO] Response contains tool calls: [{'name': 'summarize_by_time', 'args': {'time_unit': 'days', 'rollback_time': 1.0, 'channel_id': '1384535346905092127'}, 'id': 'abf1e3a2-e580-42fe-8afe-681d034a7022', 'type': 'tool_call'}]
2025-07-11 13:03:09,727 [WARNING] Shard ID None heartbeat blocked for more than 10 seconds.
Loop thread traceback (most recent call last):
  File "/home/justin/Infosys/discord_chatbot/discord_bot.py", line 342, in <module>
    client.run(discord_token)
  File "/home/justin/Infosys/discord_chatbot/.venv/lib/python3.12/site-packages/discord/client.py", line 906, in run
    asyncio.run(runner())
  File "/usr/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
  File "/usr/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
  File "/usr/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
  File "/usr/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1987, in _run_once
    handle._run()
  File "/usr/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/home/justin/Infosys/discord_chatbot/.venv/lib/python3.12/site-packages/discord/client.py", line 481, in _run_event
    await coro(*args, **kwargs)
  File "/home/justin/Infosys/discord_chatbot/discord_bot.py", line 272, in on_message
    response = agent.invoke({
  File "/home/justin/Infosys/discord_chatbot/agent.py", line 113, in invoke
    return self.graph.invoke(state, config)
  File "/home/justin/Infosys/discord_chatbot/.venv/lib/python3.12/site-packages/langgraph/pregel/__init__.py", line 2719, in invoke
    for chunk in self.stream(
  File "/home/justin/Infosys/discord_chatbot/.venv/lib/python3.12/site-packages/langgraph/pregel/__init__.py", line 2436, in stream
    for _ in runner.tick(
  File "/home/justin/Infosys/discord_chatbot/.venv/lib/python3.12/site-packages/langgraph/pregel/runner.py", line 162, in tick
    run_with_retry(
  File "/home/justin/Infosys/discord_chatbot/.venv/lib/python3.12/site-packages/langgraph/pregel/retry.py", line 40, in run_with_retry
    return task.proc.invoke(task.input, config)
  File "/home/justin/Infosys/discord_chatbot/.venv/lib/python3.12/site-packages/langgraph/utils/runnable.py", line 623, in invoke
    input = context.run(step.invoke, input, config, **kwargs)
  File "/home/justin/Infosys/discord_chatbot/.venv/lib/python3.12/site-packages/langgraph/utils/runnable.py", line 377, in invoke
    ret = self.func(*args, **kwargs)
  File "/home/justin/Infosys/discord_chatbot/agent.py", line 495, in tools_node
    result = self.tools.invoke(state)
  File "/home/justin/Infosys/discord_chatbot/.venv/lib/python3.12/site-packages/langgraph/utils/runnable.py", line 377, in invoke
    ret = self.func(*args, **kwargs)
  File "/home/justin/Infosys/discord_chatbot/.venv/lib/python3.12/site-packages/langgraph/prebuilt/tool_node.py", line 239, in _func
    outputs = [
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 619, in result_iterator
    yield _result_or_cancel(fs.pop())
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 317, in _result_or_cancel
    return fut.result(timeout)
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 451, in result
    self._condition.wait(timeout)
  File "/usr/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()

2025-07-11 13:03:10,446 [INFO] Response contains tool calls: [{'name': 'summarize_by_time', 'args': {'time_unit': 'days', 'rollback_time': 1.0, 'channel_id': '1384535346905092127'}, 'id': '8ca6898d-e183-41bc-a513-d8b0e1522bb6', 'type': 'tool_call'}]
2025-07-11 13:03:11,859 [INFO] Response contains tool calls: [{'name': 'summarize_by_time', 'args': {'time_unit': 'days', 'rollback_time': 1.0, 'channel_id': '1384535346905092127'}, 'id': '456b04b0-dca8-413e-b40d-48bc53b27613', 'type': 'tool_call'}]
